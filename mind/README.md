# Cute Fem Bot Mind

## Конфиг и данные

Всё находится в папке `data`. Конфиг кладётся там в файл `config.yml`.

## Тесты

```bash
MIX_ENV=test mix test --no-start
```

> Важно указать `MIX_ENV=test`, чтобы сработала подготовка **тестовой** БД.

## Деплой

Подготовка вольюма:

```bash
sudo docker volume create cute-fem-bot-state
```

Сборка образа:

```bash
sudo docker build -t cute-fem-bot .
```

Запуск:

```bash
sudo docker run \
    # В этом пути должен лежать config.yml и будет использоваться база main.db
    -v /path/to/data:/app/data \
    # Чтобы таймзоны работали, используются системные
    -v /usr/share/zoneinfo:/usr/share/zoneinfo \
    -d cute-fem-bot
```

## TODO

- [x] Расписание и постинг: SFW/NSFW, альтерация кронов (т.е. указание нескольких и использование их одновременно)
- [x] Надёжное хранение состояния приложения. ets? **upd**: Ecto + SQLite
- [ ] Поменять форматирование пользователей, сделать явный пермалинк
- [ ] Добавить команду админу на перезалив того, что ещё не было аппрувнуто
- [ ] Обрабатывать медиа-группы как медиа-группы
- [ ] Сделать просмотр очереди более удобным - быстрая пагинация, просмотр сразу нескольких медиа (5 разом)
- [ ] При постинге сжатых картинок постить их дополнительно и разжатыми?
- [ ] Использовать в проде SSL и Webhook
- [ ] Добавить эндпоинт для постинга картинок напрямую? Для Оливера
- [ ] Писать админам статистику о прибытии/отбытии пользователей из канала
- [ ] Сохранять пользовательское форматирование при отправке его текста в предложку
- [ ] Вынести модуль Telegram отдельно, сделать в нём адаптер HTTP


